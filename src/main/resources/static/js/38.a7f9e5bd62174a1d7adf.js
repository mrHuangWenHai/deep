webpackJsonp([38],{ShHl:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l("mvHQ"),s=l.n(i),a=l("BO1k"),n=l.n(a),r=l("fZjL"),o=l.n(r),u=l("QOcB"),c=l("igLI"),d=l("JAV3"),m=l("RO48"),p={components:{BasicInfo:u.a},data:function(){return{items:[{label:"栏/栋",model:"building"},{label:"使用日期(序号)",model:"nutritionT",type:"time"},{label:"羊数",model:"quantity",type:"number",mr:!0},{label:"羊只均重/斤",model:"average",type:"number"},{label:"阶段",model:"period",type:"select",fetchSuggestions:d.f},{label:"饮水",model:"water",mr:1}],models:{building:null,nutritionT:null,quantity:1,period:null,average:null,water:null,remark:null},form:{materialA:null,materialM:null,materialO:null,materialWM:null,materialWO:null,roughageP:null,roughageD:null,roughageO:null,roughageWP:null,roughageWD:null,roughageWO:null,pickingM:null,pickingR:null,pickingO:null},cards:[{title:"精料配方(%)",items:[{label:"添加剂",model:"materialA",inputs:[""]},{label:"精料",model:"materialM",inputs:[""],type:"select",fetchSuggestions:d.a},{label:"其他",model:"materialO",inputs:[""]}]},{title:"精料用量(体重%)",items:[{label:"精料",model:"materialWM",inputs:[""]},{label:"其他",model:"materialWO",inputs:[""]}]},{title:"粗饲料配方(%)",items:[{label:"青料",model:"roughageP",inputs:[""]},{label:"干料",model:"roughageD",type:"select",fetchSuggestions:d.c,inputs:[""]},{label:"其他",model:"roughageO",inputs:[""]}]},{title:"粗饲料用量(体重%)",items:[{label:"青料",model:"roughageWP",inputs:[""]},{label:"干料",model:"roughageWD",type:"select",fetchSuggestions:d.c,inputs:[""]},{label:"其他",model:"roughageWO",inputs:[""]}]},{title:"领料总量",items:[{label:"精料",model:"pickingM",inputs:[""],placeholder:"名称和单位（斤 / 公斤）"},{label:"粗料",model:"pickingR",inputs:[""],placeholder:"名称和单位（斤 / 公斤）"},{label:"其他",model:"pickingO",inputs:[""],placeholder:"名称和单位（斤 / 公斤）"}]}],disableBtn:!1,canModify:!0,edit:!1,check:!1,supervise:!1,view:!1}},watch:{$route:function(e,t){t.query.edit&&!e.query.edit&&(this.edit=!1)}},created:function(){var e=this,t=this.$route.params.id;Object(m._13)(t).then(function(t){Object(c.i)(t)&&(e.user=t.data.model)})},mounted:function(){var e=this;this.edit=this.$route.query.edit||this.$route.query.check||this.$route.query.supervise||this.view,this.edit&&Object(m._11)(this.edit).then(function(t){if(Object(c.i)(t)){var l=t.data.model,i={};o()(e.models).forEach(function(e){i[e]=l[e]}),o()(e.form).forEach(function(t){var i=!0,s=!1,a=void 0;try{for(var r,o=n()(e.cards);!(i=(r=o.next()).done);i=!0){var u=r.value.items.find(function(e){return e.model===t});if(u){u.inputs=l[t]&&JSON.parse(l[t]);break}}}catch(e){s=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(s)throw a}}}),e.models=i,console.log(e.models,e.cards)}})},methods:{addItem:function(e,t){this.cards[e].items[t].inputs.push("")},deleteItem:function(e,t,l){this.cards[e].items[t].inputs.splice(l,1)},change:function(e,t,l,i){this.cards[t].items[l].inputs.splice(i,1,e)},submit:function(){var e=this;if(o()(this.$refs).forEach(function(t){var l=t.substr(0,t.indexOf("-"));Array.isArray(e.form[l])?e.form[l].push(e.$refs[t][0].$el.querySelector("input").value):e.form[l]=[e.$refs[t][0].$el.querySelector("input").value]}),console.log(this.models),o()(this.form).forEach(function(t){e.models[t]=s()(e.form[t])}),Object(c.b)(this.models)){var t=this.user,l=t.userFactory,i=t.userRealname,a=t.id,n=t.factoryName;this.models.factoryNum=l,this.models.factoryName=n,this.models.operatorId=a,this.models.operatorName=i,this.disableBtn=!0,this.edit?Object(m._52)(this.edit,this.models).then(function(t){Object(c.i)(t)&&Object(c.l)("nutrition/stage"),e.disableBtn=!1},function(t){e.disableBtn=!1,e.$message.error("修改失败")}):Object(m._39)(this.models).then(function(t){Object(c.i)(t)&&Object(c.m)("nutrition/stage"),e.disableBtn=!1},function(t){e.disableBtn=!1,e.$message.error("录入失败")})}}}},f={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"admin-form"},[l("p",{staticClass:"card-title"},[e._v("阶段营养实施档案")]),e._v(" "),l("basic-info",{attrs:{items:e.items,models:e.models}}),e._v(" "),e._l(e.cards,function(t,i){return l("div",{key:i,staticClass:"card"},[l("p",{staticClass:"card-title",domProps:{textContent:e._s(t.title)}}),e._v(" "),l("div",{staticClass:"border-main"},e._l(t.items,function(t,s){return l("div",{key:s,staticClass:"card-item"},[e._l(t.inputs,function(a,n){return[void 0===t.type||"text"===t.type?l("el-input",{key:n,ref:t.model+"-"+n,refInFor:!0,attrs:{value:a,placeholder:t.placeholder||"名称和百分比",size:"small"},on:{change:function(t){e.change(a,i,s,n)}}},[l("template",{slot:"prepend"},[e._v(e._s(t.label)+":")])],2):"select"===t.type?l("div",{key:n,staticClass:"time el-input-group select"},[l("span",{staticClass:"time-span",domProps:{textContent:e._s(t.label+":")}}),e._v(" "),l("el-autocomplete",{ref:t.model+"-"+n,refInFor:!0,attrs:{value:a,placeholder:t.placeholder||"名称和百分比",size:"small","fetch-suggestions":t.fetchSuggestions},on:{select:function(t){return e.change(t.value,i,s,n)}}})],1):e._e(),e._v(" "),n?l("el-button",{key:s+"-"+n,attrs:{type:"primary",size:"small"},on:{click:function(t){e.deleteItem(i,s,n)}}},[e._v("删除")]):e._e()]}),e._v(" "),l("span",{staticClass:"cursor-p",on:{click:function(t){e.addItem(i,s)}}},[l("i",{staticClass:"el-icon-caret-right"}),e._v("增加"+e._s(t.label)+"设置")])],2)}))])}),e._v(" "),l("div",{staticClass:"card"},[l("p",{staticClass:"card-title"},[e._v("备注:")]),e._v(" "),l("el-input",{attrs:{type:"textarea"},model:{value:e.models.remark,callback:function(t){e.$set(e.models,"remark",t)},expression:"models.remark"}})],1),e._v(" "),e.canModify?l("div",{staticClass:"admin-send"},[e.check||e.view?e.view?l("el-button",{attrs:{type:"primary",disabled:e.disableBtn},on:{click:function(t){e.$router.back()}}},[e._v("返回")]):[l("el-button",{attrs:{type:"primary",disabled:e.disableBtn},on:{click:function(t){e.Spv(!0)}}},[e._v("通过")]),e._v(" "),l("el-button",{attrs:{type:"primary",disabled:e.disableBtn},on:{click:function(t){e.Spv()}}},[e._v("拒绝")])]:l("el-button",{attrs:{type:"primary",disabled:e.disableBtn},on:{click:function(t){e.submit()}}},[e._v("提交/更新")])],2):l("div",{staticClass:"admin-send"},[e._v("已审核")])],2)},staticRenderFns:[]},h=l("VU/8")(p,f,!1,null,null,null);t.default=h.exports}});
//# sourceMappingURL=38.a7f9e5bd62174a1d7adf.js.map