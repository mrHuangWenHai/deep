webpackJsonp([23],{"I/LN":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("f+26"),a=i("RO48"),n=i("igLI"),o={data:function(){return{url:s.b+"/video/upload",fileList:[],data:{},disabled:!1,videoList:[],total:0,page:1}},created:function(){var e=this,t=this.$route.params.id;Object(a._13)(t).then(function(i){Object(n.i)(i)&&(e.data={professorId:t,professorName:i.data.pkUserid})}),this.getVideoList()},methods:{submitUpload:function(){if(!this.fileList.length)return this.$message.warning("请选取视频文件"),!1;this.$refs.upload.submit(),this.disabled=!0},exceed:function(){this.$message.warning("每次只能上传一个视频")},checkFile:function(e){e.name.substring(e.name.indexOf(".")+1);var t=e.size/1024/1024<=500;return!!t||(this.$message.warning("视频文件大小不能超过500M"),t)},change:function(e){"ready"===e.status&&this.fileList.push(e)},success:function(e){Object(n.i)(e)&&(this.$refs.upload.clearFiles(),this.fileList=[],this.disabled=!1,this.$message.success("视频上传成功"))},error:function(){this.$refs.upload.clearFiles(),this.fileList=[],this.disabled=!1,this.$message.error("视频上传失败，请重新上传")},getVideoList:function(){var e=this;Object(a._14)({page:this.page-1}).then(function(t){e.videoList=[],Object(n.i)(t)&&(e.total=t.data.size||0,t.data.List.forEach(function(t){e.videoList.push({id:t.id,gmtCreate:t.gmtCreate,professorName:t.professorName,fileName:t.fileName})}))})},downloadLink:function(e){return s.b+"/movie/"+this.videoList[e].fileName},deleteVideo:function(e){var t=this;this.$confirm("此操作将永久删除该视频文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.v)(t.videoList[e].id).then(function(e){Object(n.i)(e)&&(t.$message.success("该条视频删除成功"),t.getVideoList())})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mod_professorCourseVideo"},[i("el-upload",{ref:"upload",staticClass:"professorCourseVideo_upload",attrs:{action:e.url,data:e.data,name:"file","file-list":e.fileList,disabled:e.disabled,limit:1,accept:"video/*","on-exceed":e.exceed,"before-upload":e.checkFile,"on-change":e.change,"on-success":e.success,"on-error":e.error,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取课堂视频")]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{disabled:e.disabled,size:"small",type:"success"},on:{click:e.submitUpload}},[e._v("上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传视频文件，且不超过500M")])],1),e._v(" "),i("el-table",{ref:"table",staticClass:"admin-table",staticStyle:{width:"100%"},attrs:{"tooltip-effect":"light",data:e.videoList}},[i("el-table-column",{attrs:{prop:"gmtCreate",label:"上传日期",align:"center",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"professorName",label:"专家姓名",align:"center",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"fileName",label:"视频名称",align:"center"}}),e._v(" "),i("el-table-column",{staticClass:"action",attrs:{label:"操作",align:"center",fixed:"right",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"opr"},[i("a",{staticClass:"opr_download",attrs:{href:e.downloadLink(t.$index),download:""}},[e._v("下载")]),e._v(" "),i("span",{staticClass:"opr_delete",on:{click:function(i){e.deleteVideo(t.$index)}}},[e._v("删除")])])]}}])})],1),e._v(" "),i("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total,"current-page":e.page},on:{"current-change":e.getVideoList,"update:currentPage":function(t){e.page=t}}})],1)},staticRenderFns:[]};var r=i("VU/8")(o,l,!1,function(e){i("tuGp")},null,null);t.default=r.exports},tuGp:function(e,t){}});
//# sourceMappingURL=23.b06b37956d395e5268cb.js.map