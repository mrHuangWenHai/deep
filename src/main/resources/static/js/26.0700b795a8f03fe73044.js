webpackJsonp([26],{"4/8X":function(e,t){},VICC:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=l("BO1k"),i=l.n(s),a=l("igLI"),n=l("RO48"),r={watch:{userid:function(e){this.userrole=this.empOptions.find(function(t){return t.value===e}).role}},data:function(){return{load:!1,page:1,total:1,userid:null,userrole:null,empOptions:[],roleOptions:[],typeName:"",roleDescription:"",rules:[],tableData:[],addUserVisible:!1,checkAll:[],items:[{text:"配种产子档案",supervise:1},{text:"疾病防治档案",supervise:1},{text:"卫生消毒档案",supervise:1},{text:"免疫实施档案",supervise:1},{text:"阶段营养档案",supervise:1},{text:"卫生动物福利档案",supervise:1},{text:"驱虫实施档案",supervise:1},{text:"专家评价",totalScore:1},{text:"方案"},{text:"代理"},{text:"客户"},{text:"直播"},{text:"信息发布"},{text:"系谱档案"},{text:"视频"},{text:"图片"},{text:"用户"},{text:"专家"},{text:"技术员"},{text:"管理员"},{text:"角色管理"},{text:"短信",msg:1},{text:"下载",downloadExcel:1},{text:"羊品种"},{text:"文件",file:1},{text:"留言",note:1}]}},mounted:function(){var e=this,t=this.$route.params.id;Object(n._13)(t).then(function(t){Object(a.i)(t)&&(e.user=t.data.model,e.user.agentRank=t.data.agentRank)}).then(function(t){Object(n._10)(e.user.agentRank,{size:100}).then(function(t){if(Object(a.i)(t)){var l=!0,s=!1,n=void 0;try{for(var r,o=i()(t.data.List);!(l=(r=o.next()).done);l=!0){var c=r.value;e.roleOptions.push({label:c.typeName,value:c.id})}}catch(e){s=!0,n=e}finally{try{!l&&o.return&&o.return()}finally{if(s)throw n}}}})}).then(function(t){Object(n._0)(e.user.userFactory).then(function(t){if(Object(a.i)(t)){var l=!0,s=!1,n=void 0;try{for(var r,o=i()(t.data.List);!(l=(r=o.next()).done);l=!0){var c=r.value;e.empOptions.push({label:c.pkUserid,value:c.id,role:c.userRole})}}catch(e){s=!0,n=e}finally{try{!l&&o.return&&o.return()}finally{if(s)throw n}}}})}).then(this.fetchRoles)},methods:{handleClose:function(e){this.editId=this.typeName=this.roleDescription=null,this.rules=[],e()},cancle:function(){this.editId=this.typeName=this.roleDescription=null,this.rules=[],this.addUserVisible=!1},hanldeDeleteRole:function(e){var t=this;this.$confirm("将永久删除此条记录, 是否继续?","提示",{type:"warning"}).then(function(){var l=t.tableData[e].id;Object(n.s)(l).then(function(e){Object(a.i)(e)&&(t.$message.success("删除成功"),t.fetchRoles())})}).catch(function(){return!1})},updateEmployee:function(){var e=this;Object(n._54)(this.userid,this.userrole).then(function(t){Object(a.i)(t)&&e.$message.success("修改员工角色成功")},function(t){e.$message.error("修改员工角色失败")})},fetchRoles:function(){var e=this;this.load=!0,Object(n._10)(this.user.agentRank,{page:this.page-1}).then(function(t){Object(a.i)(t)&&(e.tableData=t.data.List,e.total=t.data.size),e.load=!1},function(t){e.$message.error("获取角色失败"),e.load=!1})},submit:function(){var e=this,t=this.typeName,l=this.roleDescription;if(t)if(l)if(this.rules.length){var s={roleDescription:l,typeName:t,rolePermit:this.rules};this.editId?Object(n._51)(this.editId,s).then(function(t){Object(a.i)(t)&&(e.$message.success("修改角色成功"),e.typeName=e.roleDescription=null,e.rules=[],e.fetchRoles()),e.addUserVisible=!1},function(t){e.$message.error("修改角色失败"),e.addUserVisible=!1}):Object(n._38)(s).then(function(s){Object(a.i)(s)&&(e.$message.success("添加角色成功"),e.tableData.unshift({id:s.data.model,typeName:t,roleDescription:l,rolePermit:e.rules}),e.tableData.length>10&&e.tableData.pop(),e.typeName=e.roleDescription=null,e.rules=[]),e.addUserVisible=!1},function(t){e.$message.success("添加角色失败"),e.addUserVisible=!1})}else this.$message.warning("请赋予角色权限");else this.$message.warning("请填写角色说明");else this.$message.warning("请填写角色名")},preEdit:function(e){var t=this.tableData[e],l=t.id,s=t.typeName,i=t.roleDescription;this.editId=l,this.typeName=s,this.roleDescription=i,this.rules=t.rolePermit,this.addUserVisible=!0},handleCheckAllChange:function(e,t){var l=4;for(e.supervise&&(l+=2),e.totalScore&&l++;--l>=0;){var s=t+"-"+l;this.rules.includes(s)?this.checkAll[t]||this.rules.splice(this.rules.indexOf(s),1):this.checkAll[t]&&this.rules.push(s)}}}},o={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"auth-role"},[l("el-button",{on:{click:function(t){e.addUserVisible=!0}}},[e._v("添加角色")]),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.load,expression:"load"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[l("el-table-column",{attrs:{prop:"typeName",label:"角色名",align:"center",width:"240"}}),e._v(" "),l("el-table-column",{attrs:{prop:"id",label:"角色编号",align:"center",width:"240"}}),e._v(" "),l("el-table-column",{attrs:{prop:"roleDescription",label:"角色说明",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{align:"center",width:"160",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{size:"mini"},on:{click:function(l){e.preEdit(t.$index)}}},[e._v("编辑")]),e._v(" "),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){e.hanldeDeleteRole(t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),l("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total,"current-page":e.page},on:{"current-change":e.fetchRoles,"update:currentPage":function(t){e.page=t}}}),e._v(" "),l("el-dialog",{staticClass:"role-dialogue",attrs:{"before-close":e.handleClose,visible:e.addUserVisible,model:e.rules,width:"50%",center:""},on:{"update:visible":function(t){e.addUserVisible=t}}},[l("el-input",{attrs:{size:"small"},model:{value:e.typeName,callback:function(t){e.typeName=t},expression:"typeName"}},[l("template",{slot:"prepend"},[e._v("角色名:")])],2),e._v(" "),l("el-input",{attrs:{size:"small"},model:{value:e.roleDescription,callback:function(t){e.roleDescription=t},expression:"roleDescription"}},[l("template",{slot:"prepend"},[e._v("角色说明:")])],2),e._v(" "),e._l(e.items,function(t,s){return l("div",{key:s,staticClass:"rules"},[l("el-checkbox",{on:{change:function(l){e.handleCheckAllChange(t,s)}},model:{value:e.checkAll[s],callback:function(t){e.$set(e.checkAll,s,t)},expression:"checkAll[i]"}},[l("span",{domProps:{textContent:e._s(t.text)}})]),e._v(" "),l("el-checkbox-group",{model:{value:e.rules,callback:function(t){e.rules=t},expression:"rules"}},[t.msg?[l("el-checkbox",{attrs:{label:s+"-0"}},[e._v("发送短信")]),e._v(" "),l("el-checkbox",{attrs:{label:s+"-1"}},[e._v("编辑短信")])]:t.downloadExcel?[l("el-checkbox",{attrs:{label:s+"-0"}},[e._v("下载数据库表格")])]:t.file?[l("el-checkbox",{attrs:{label:s+"-0"}},[e._v("下载文件")])]:t.note?[l("el-checkbox",{attrs:{label:s+"-0"}},[e._v("查看留言")])]:[l("el-checkbox",{attrs:{label:s+"-0"}},[e._v("增加")]),e._v(" "),l("el-checkbox",{attrs:{label:s+"-1"}},[e._v("删除")]),e._v(" "),l("el-checkbox",{attrs:{label:s+"-2"}},[e._v("查询")]),e._v(" "),l("el-checkbox",{attrs:{label:s+"-3"}},[e._v("修改")]),e._v(" "),t.supervise?[l("el-checkbox",{attrs:{label:s+"-4"}},[e._v("监督")]),e._v(" "),l("el-checkbox",{attrs:{label:s+"-5"}},[e._v("审核")])]:e._e(),e._v(" "),t.totalScore?l("el-checkbox",{attrs:{label:s+"-6"}},[e._v("查看总评分")]):e._e()]],2)],1)}),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{size:"small"},on:{click:function(t){e.cancle()}}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.submit()}}},[e._v("提交")])],1)],2),e._v(" "),l("h3",[e._v("员工角色")]),e._v(" "),l("div",{staticClass:"employee"},[e._v("\n        员工\n        "),l("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.userid,callback:function(t){e.userid=t},expression:"userid"}},e._l(e.empOptions,function(e,t){return l("el-option",{key:"emo"+t,attrs:{label:e.label,value:e.value}})})),e._v("\n        角色\n        "),l("el-select",{attrs:{size:"small",placeholder:"请选择"},model:{value:e.userrole,callback:function(t){e.userrole=t},expression:"userrole"}},e._l(e.roleOptions,function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.updateEmployee()}}},[e._v("提交/更新")])],1)},staticRenderFns:[]};var c=l("VU/8")(r,o,!1,function(e){l("4/8X")},null,null);t.default=c.exports}});
//# sourceMappingURL=26.0700b795a8f03fe73044.js.map